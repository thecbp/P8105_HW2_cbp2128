R Notebook
================

Preliminary imports
===================

We need to practice our data wrangling and tidying skills, in addition to importing different types of data. Thus, we'll bring in `tidyverse` and `readxl`.

``` r
library(tidyverse)
library(readxl)
library(knitr)
```

Problem 1
=========

This problem requires us to bring in the NYC Transit dataset and clean up the data. The data is contained within a subdirectory of the project, so we'll pull it from there.

``` r
raw_nyc_data = read_csv(file = './data/P1/nyc_subway.csv')
```

`raw_nyc_data` in its current state is far from tidy form. Each route has its own column, and many of the cells in these route columns are missing. Some stations have multiple rows that only differ on the entrance locations, making much of the dataset redundant if we don't care about the entrance details. Lastly, the problem doesn't need many of the columns in the raw dataset, so they can be safely excluded.

As we clean the data, we'll address these issues and end up with a tidy data set.

``` r
tidy_nyc_data = raw_nyc_data %>% 
  janitor::clean_names() %>% 
  gather(data = ., key = route_number, value = route_served, route1:route11, na.rm = TRUE) %>% 
  mutate(can_enter = ifelse(entry == "YES", TRUE, FALSE),
         has_vending = ifelse(vending == "YES", TRUE, FALSE)) %>% 
  select(., station_name, line, route_served, station_latitude, station_longitude, 
         entrance_type, can_enter, has_vending, is_ada = ada) %>% 
  distinct(., station_name, line, route_served, .keep_all = TRUE) %>%
  arrange(., station_name, line) 
```

The cleaning process
--------------------

`tidy_nyc_data` is the result of our tidying process. After fixing up the column names, I gathered all of the route columns so that we get a 1-to-1 correspondence to each station and every route they serve. Gathering the routes removes the multitude of missing values present in the route columns. `entry` and `vending` have been converted into true Boolean variables and have been renamed to be more descriptive of their "yes/no" nature (the same renaming was done to `ada`). I used `select()` to rearrange the columns to give station the main focus, while removing extraneous columns not required in the problem. Since many of the stations have multiple entrances, I used `distinct()` to make sure that each station-to-route pair is unique.

The ending result keeps the station and line information, and each route has its own row. Other station information such as the station location, entrance type, ADA status has been kept. Customers who may need to figure out if they can even enter a particular station or purchase a Metro Card can use the corresponding Boolean columns.

The original dataset had 1868 rows and 32 columns, while the processed dataset has been reduced to 981 rows and 9 columns. Some stations are seen multiple times if they house different lines or serve multiple routes. The data is now in tidy form.

NYC Transit Data Inquiry
------------------------

### How many distinct stations are there?

If each station is identified by the station and line, then we can use the `distinct()` function again. A station is stated to be uniquely identifiable by a station-line combination, so we'll make sure that we remove duplicates based on both of these columns.

``` r
distinct_stations = tidy_nyc_data %>% 
  distinct(., station_name, line, .keep_all = TRUE)
```

`distinct_stations` tells us that there are 465 distinct stations.

### How many stations are ADA compliant?

Using the `is_ada` column, we can inquire how many of the stations are ADA compliant. Since we need to look at distinct stations, we can use the same code from above and just count how many rows in `is_ada` are `TRUE`.

``` r
are_ada_compliant = sum(distinct_stations$is_ada)
```

84 distinct stations are ADA compliant.

### What proportion of station entrances / exits without vending allow entrance?

We are asked to calculate the proportion of station entrances that allow entrance, given that they don't have vending. We can calculate this from our `distinct_stations` dataset.

``` r
without_vending = filter(distinct_stations, distinct_stations$has_vending == FALSE)
is_enterable = sum(without_vending$can_enter == TRUE)
```

The proportion of stations without vending that allow entrance is 0.5555556.

### How many distinct stations serve the A train? How many of them ADA compliant?

I didn't read far enough ahead to realize that I was supposed to be gathering the routes into their own column, but I can still answer this question.

``` r
serves_A = filter(distinct_stations, route_served == "A")
ada_compliant_A_trains = sum(serves_A$is_ada == TRUE)
```

The number of distinct stations that serve the A train is 60, and the number of them that are compliant is 17.
